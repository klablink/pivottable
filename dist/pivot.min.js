"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _createForOfIteratorHelper(t,e){var r,n,a,o,l="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(l)return n=!(r=!0),{s:function(){l=l.call(t)},n:function(){var t=l.next();return r=t.done,t},e:function(t){n=!0,a=t},f:function(){try{r||null==l.return||l.return()}finally{if(n)throw a}}};if(Array.isArray(t)||(l=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length)return l&&(t=l),o=0,{s:e=function(){},n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:e};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){t=_toPrimitive(t,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0===r)return("string"===e?String:Number)(t);r=r.call(t,e||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){var r;if(t)return"string"==typeof t?_arrayLikeToArray(t,e):"Map"===(r="Object"===(r=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:r)||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function _iterableToArrayLimit(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,a,o,l,i=[],s=!0,u=!1;try{if(o=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=o.call(r)).done)&&(i.push(n.value),i.length!==e);s=!0);}catch(t){u=!0,a=t}finally{try{if(!s&&null!=r.return&&(l=r.return(),Object(l)!==l))return}finally{if(u)throw a}}return i}}function _arrayWithHoles(t){if(Array.isArray(t))return t}!function(st){function X(t,e,r,n){var a,o=st(t).closest("table"),l=e?"rowSpan":"colSpan",i=e?1:Math.max(1,this.aggregator.length),i=[t[l],null!=t._span?t._span:i],s=(t._span=i[0],t[l]=i[1],t[l]-t._span),u=A(r,n);for(a in u){var c,d=u[a];if(1===(c=_(o,e,d)[0])[l]){c._span+=s;break}c[l]+=s}return Z(t,e,r,n,c)}function t(e){return e=st.extend({},{digitsAfterDecimal:2,scaler:1,thousandsSep:",",decimalSep:".",prefix:"",suffix:""},e),function(t){return isNaN(t)||!isFinite(t)?"":(t=function(t,e,r){for(var t=(t+="").split("."),n=t[0],r=1<t.length?r+t[1]:"",a=/(\d+)(\d{3})/;a.test(n);)n=n.replace(a,"$1"+e+"$2");return n+r}((e.scaler*t).toFixed(e.digitsAfterDecimal),e.thousandsSep,e.decimalSep),""+e.prefix+t+e.suffix)}}var e=t(),r=t({digitsAfterDecimal:0}),n=t({digitsAfterDecimal:1,scaler:100,suffix:"%"}),s={count:function(n){return null==n&&(n=r),function(){return function(t,e,r){return{count:0,push:function(){return this.count++},value:function(){return this.count},format:n}}}},uniques:function(a,o){return null==o&&(o=r),function(){var n=_slicedToArray(arguments.length<=0?void 0:arguments[0],1)[0];return function(t,e,r){return{uniq:[],push:function(t){if(!this.uniq.includes(t[n]))return this.uniq.push(t[n])},value:function(){return a(this.uniq)},format:o,numInputs:null!=n?0:1}}}},sum:function(a){return null==a&&(a=e),function(){var n=_slicedToArray(arguments.length<=0?void 0:arguments[0],1)[0];return function(t,e,r){return{sum:0,push:function(t){if(!isNaN(parseFloat(t[n])))return this.sum+=parseFloat(t[n])},value:function(){return this.sum},format:a,numInputs:null!=n?0:1}}}},extremes:function(a,o){return null==o&&(o=e),function(){var n=_slicedToArray(arguments.length<=0?void 0:arguments[0],1)[0];return function(t,e,r){return{val:null,sorter:ht(null!=t?t.sorters:void 0,n),push:function(t){t=t[n];if(["min","max"].includes(a)&&(t=parseFloat(t),isNaN(t)||(this.val=Math[a](t,null!=this.val?this.val:t))),"first"===a&&this.sorter(t,null!=this.val?this.val:t)<=0&&(this.val=t),"last"===a&&0<=this.sorter(t,null!=this.val?this.val:t))return this.val=t},value:function(){return this.val},format:function(t){return isNaN(t)?t:o(t)},numInputs:null!=n?0:1}}}},quantile:function(a,o){return null==o&&(o=e),function(){var n=_slicedToArray(arguments.length<=0?void 0:arguments[0],1)[0];return function(t,e,r){return{vals:[],push:function(t){t=parseFloat(t[n]);if(!isNaN(t))return this.vals.push(t)},value:function(){if(0===this.vals.length)return null;this.vals.sort(function(t,e){return t-e});var t=(this.vals.length-1)*a;return(this.vals[Math.floor(t)]+this.vals[Math.ceil(t)])/2},format:o,numInputs:null!=n?0:1}}}},runningStat:function(a,o,l){return null==a&&(a="mean"),null==o&&(o=1),null==l&&(l=e),function(){var n=_slicedToArray(arguments.length<=0?void 0:arguments[0],1)[0];return function(t,e,r){return{n:0,m:0,s:0,push:function(t){var e,t=parseFloat(t[n]);if(!isNaN(t))return this.n+=1,1===this.n?this.m=t:(e=this.m+(t-this.m)/this.n,this.s=this.s+(t-this.m)*(t-e),this.m=e)},value:function(){if("mean"===a)return 0===this.n?NaN:this.m;if(this.n<=o)return 0;switch(a){case"var":return this.s/(this.n-o);case"stdev":return Math.sqrt(this.s/(this.n-o))}},format:l,numInputs:null!=n?0:1}}}},sumOverSum:function(o){return null==o&&(o=e),function(){var t=_slicedToArray(arguments.length<=0?void 0:arguments[0],2),n=t[0],a=t[1];return function(t,e,r){return{sumNum:0,sumDenom:0,push:function(t){if(isNaN(parseFloat(t[n]))||(this.sumNum+=parseFloat(t[n])),!isNaN(parseFloat(t[a])))return this.sumDenom+=parseFloat(t[a])},value:function(){return this.sumNum/this.sumDenom},format:o,numInputs:null!=n&&null!=a?0:2}}}},sumOverSumBound80:function(o,l){return null==o&&(o=!0),null==l&&(l=e),function(){var t=_slicedToArray(arguments.length<=0?void 0:arguments[0],2),n=t[0],a=t[1];return function(t,e,r){return{sumNum:0,sumDenom:0,push:function(t){if(isNaN(parseFloat(t[n]))||(this.sumNum+=parseFloat(t[n])),!isNaN(parseFloat(t[a])))return this.sumDenom+=parseFloat(t[a])},value:function(){var t=o?1:-1;return(.821187207574908/this.sumDenom+this.sumNum/this.sumDenom+1.2815515655446004*t*Math.sqrt(.410593603787454/(this.sumDenom*this.sumDenom)+this.sumNum*(1-this.sumNum/this.sumDenom)/(this.sumDenom*this.sumDenom)))/(1+1.642374415149816/this.sumDenom)},format:l,numInputs:null!=n&&null!=a?0:2}}}},fractionOf:function(a,o,l){return null==o&&(o="total"),null==l&&(l=n),function(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];return function(e,t,r){return{selector:{total:[[],[]],row:[t,[]],col:[[],r]}[o],inner:a.apply(void 0,_toConsumableArray(n||[]))(e,t,r),push:function(t){return this.inner.push(t)},format:l,value:function(t){t=e.getAggregator.apply(e,_toConsumableArray([].concat(_toConsumableArray(this.selector),[t])||[]));return this.inner.value()/t.inner.value()},numInputs:a.apply(void 0,_toConsumableArray(n||[]))().numInputs}}}}};function ut(t,e,r){return{Count:s.count(e),"Count Unique Values":s.countUnique(e),"List Unique Values":s.listUnique(", "),Sum:s.sum(t),"Integer Sum":s.sum(e),Average:s.average(t),Median:s.median(t),"Sample Variance":s.var(1,t),"Sample Standard Deviation":s.stdev(1,t),Minimum:s.min(t),Maximum:s.max(t),First:s.first(t),Last:s.last(t),"Sum over Sum":s.sumOverSum(t),"80% Upper Bound":s.sumOverSumBound80(!0,t),"80% Lower Bound":s.sumOverSumBound80(!1,t),"Sum as Fraction of Total":s.fractionOf(s.sum(),"total",r),"Sum as Fraction of Rows":s.fractionOf(s.sum(),"row",r),"Sum as Fraction of Columns":s.fractionOf(s.sum(),"col",r),"Count as Fraction of Total":s.fractionOf(s.count(),"total",r),"Count as Fraction of Rows":s.fractionOf(s.count(),"row",r),"Count as Fraction of Columns":s.fractionOf(s.count(),"col",r)}}s.countUnique=function(t){return s.uniques(function(t){return t.length},t)},s.listUnique=function(e){return s.uniques(function(t){return t.sort(pt).join(e)},function(t){return t})},s.max=function(t){return s.extremes("max",t)},s.min=function(t){return s.extremes("min",t)},s.first=function(t){return s.extremes("first",t)},s.last=function(t){return s.extremes("last",t)},s.median=function(t){return s.quantile(.5,t)},s.average=function(t){return s.runningStat("mean",1,t)},s.var=function(t,e){return s.runningStat("var",t,e)},s.stdev=function(t,e){return s.runningStat("stdev",t,e)};for(var ct=ut(e,r,n),a={Table:v,"Table Barchart":function(t,e){return st(v(t,e)).barchart()},Heatmap:function(t,e){return st(v(t,e)).heatmap("heatmap",e)},"Row Heatmap":function(t,e){return st(v(t,e)).heatmap("rowheatmap",e)},"Col Heatmap":function(t,e){return st(v(t,e)).heatmap("colheatmap",e)}},dt={en:{formatters:{format:e,formatInt:r,formatPct:n},renderers:a,localeStrings:{renderError:"An error occurred rendering the PivotTable results.",computeError:"An error occurred computing the PivotTable results.",uiRenderError:"An error occurred rendering the PivotTable UI.",selectAll:"Select All",selectNone:"Select None",tooMany:"(too many to list)",filterResults:"Filter values",apply:"Apply",cancel:"Cancel",totals:"Totals",vs:"vs",by:"by",rendererLabel:"Renderer",valuesLabel:"Values",fieldsLabel:"Fields",colsLabel:"Columns",rowsLabel:"Rows",groupsLabel:"Groups"}}},o=0,l=Object.keys(ct);o<l.length;o++){var i=l[o];dt.en.localeStrings[i]=i}function u(t){return("0"+t).substr(-2,2)}var c=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],T=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],S={bin:function(e,r){return function(t){return t[e]-t[e]%r}},dateFormat:function(e,n,t,a,o){null==a&&(a=c),null==o&&(o=T);var l=(t=null==t?!1:t)?"UTC":"";return function(t){var r=new Date(Date.parse(t[e]));return isNaN(r)?"":n.replace(/%(.)/g,function(t,e){switch(e){case"y":return r["get".concat(l,"FullYear")]();case"m":return u(r["get".concat(l,"Month")]()+1);case"n":return a[r["get".concat(l,"Month")]()];case"d":return u(r["get".concat(l,"Date")]());case"w":return o[r["get".concat(l,"Day")]()];case"x":return r["get".concat(l,"Day")]();case"H":return u(r["get".concat(l,"Hours")]());case"M":return u(r["get".concat(l,"Minutes")]());case"S":return u(r["get".concat(l,"Seconds")]());default:return"%"+e}})}}},d=/(\d+)|(\D+)/g,p=/\d/,h=/^0/,pt=function(t,e,r){r=(r=null==r?!0:r)?1:-1;if(null!=e&&null==t)return-1*r;if(null!=t&&null==e)return r;if("number"==typeof t&&isNaN(t))return-1;if("number"==typeof e&&isNaN(e))return 1;var r=+t,n=+e;if(r<n)return-1;if(n<r)return 1;if("number"==typeof t&&"number"!=typeof e)return-1;if("number"==typeof e&&"number"!=typeof t)return 1;if("number"==typeof t&&"number"==typeof e)return 0;if(isNaN(n)&&!isNaN(r))return-1;if(isNaN(r)&&!isNaN(n))return 1;var a=String(t),o=String(e);if(a===o)return 0;if(!p.test(a)||!p.test(o))return o<a?1:-1;for(a=a.match(d),o=o.match(d);a.length&&o.length;){var l=a.shift(),i=o.shift();if(l!==i)return p.test(l)&&p.test(i)?l.replace(h,".0")-i.replace(h,".0"):i<l?1:-1}return a.length-o.length};function ht(t,e){if(null!=t)if(st.isFunction(t)){var r=t(e);if(st.isFunction(r))return r}else if(null!=t[e])return t[e];return pt}function f(t,e){return t.filter(function(t){return t.length===e})}function g(r){return r.map(function(t,e){return r.slice(0,e+1)})}function ft(t){t.map(function(t,e){return t.displayName=String.fromCharCode(97+e).toUpperCase()})}var gt=function(){function o(t,e){var r=this;_classCallCheck(this,o),this.arrSort=this.arrSort.bind(this),this.sortKeys=this.sortKeys.bind(this),this.getColKeys=this.getColKeys.bind(this),this.getRowKeys=this.getRowKeys.bind(this),this.getAggregator=this.getAggregator.bind(this),null==e&&(e={}),this.input=t,Array.isArray(e.aggregator)||(e.aggregator=null!=e.aggregator?e.aggregator:s.count()(),e.aggregator=[e.aggregator]),this.aggregator=null!=e.aggregator?e.aggregator:[s.count()()],this.aggregatorName=null!=e.aggregatorName?e.aggregatorName:"Count",this.colAttrs=null!=e.cols?e.cols:[],this.rowAttrs=null!=e.rows?e.rows:[],this.valAttrs=null!=e.vals?e.vals:[],this.sorters=null!=e.sorters?e.sorters:{},this.rowOrder=null!=e.rowOrder?e.rowOrder:"key_a_to_z",this.colOrder=null!=e.colOrder?e.colOrder:"key_a_to_z",this.derivedAttributes=null!=e.derivedAttributes?e.derivedAttributes:{},this.filter=null!=e.filter?e.filter:function(){return!0},this.tree={},this.rowKeys=[],this.colKeys=[],this.rowTotals={},this.colTotals={},this.allTotal=this.aggregator.map(function(t){return t(r,[],[])}),this.sorted=!1,this.aggregatorsLabel=null!=e.aggregatorsLabel?e.aggregatorsLabel:[],this.grouping=null!=e.grouping&&e.grouping,this.rowGroupBefore=null==(null!=e.grouping?e.grouping.rowGroupBefore:void 0)||(null!=e.grouping?e.grouping.rowGroupBefore:void 0),this.colGroupBefore=null!=(null!=e.grouping?e.grouping.colGroupBefore:void 0)&&(null!=e.grouping?e.grouping.colGroupBefore:void 0),o.forEachRecord(this.input,this.derivedAttributes,function(t){if(r.filter(t))return r.processRecord(t)})}return _createClass(o,[{key:"forEachMatchingRecord",value:function(r,n){var a=this;return o.forEachRecord(this.input,this.derivedAttributes,function(t){if(a.filter(t)){for(var e in r)if(r[e]!==(null!=t[e]?t[e]:"null"))return;return n(t)}})}},{key:"arrSort",value:function(t,o){var e,l=[],r=_createForOfIteratorHelper(t);try{for(r.s();!(e=r.n()).done;){var n=e.value;l.push(ht(this.sorters,n))}}catch(t){r.e(t)}finally{r.f()}return function(t,e){for(var r=0,n=Object.keys(l||{});r<n.length;r++){var a=n[r],a=(0,l[a])(t[a],e[a],o);if(0!==a)return a}return 0}}},{key:"sortKeys",value:function(){var r=this;if(!this.sorted){this.sorted=!0;var n=function(t,e){return r.getAggregator(t,e).value()};switch(this.rowOrder){case"value_a_to_z":this.rowKeys.sort(function(t,e){return pt(n(t,[]),n(e,[]))});break;case"value_z_to_a":this.rowKeys.sort(function(t,e){return-pt(n(t,[]),n(e,[]))});break;default:this.rowKeys.sort(this.arrSort(this.rowAttrs,this.rowGroupBefore))}switch(this.colOrder){case"value_a_to_z":return this.colKeys.sort(function(t,e){return pt(n([],t),n([],e))});case"value_z_to_a":return this.colKeys.sort(function(t,e){return-pt(n([],t),n([],e))});default:return this.colKeys.sort(this.arrSort(this.colAttrs,this.colGroupBefore))}}}},{key:"getColKeys",value:function(t){return null==t&&(t=!1),this.sortKeys(),t?this.colKeys:f(this.colKeys,this.colAttrs.length)}},{key:"getRowKeys",value:function(t){return null==t&&(t=!1),this.sortKeys(),t?this.rowKeys:f(this.rowKeys,this.rowAttrs.length)}},{key:"processRecord",value:function(l){var t,e,i=this,s=[],r=[],n=_createForOfIteratorHelper(this.colAttrs);try{for(n.s();!(e=n.n()).done;)t=e.value,s.push(null!=l[t]?l[t]:"null")}catch(t){n.e(t)}finally{n.f()}var a,o=_createForOfIteratorHelper(this.rowAttrs);try{for(o.s();!(a=o.n()).done;)t=a.value,r.push(null!=l[t]?l[t]:"null")}catch(t){o.e(t)}finally{o.f()}s=this.grouping&&s.length?g(s):[s],r=this.grouping&&r.length?g(r):[r],this.aggregator.forEach(function(t,e){return i.allTotal[e].push(l)});function u(){var e,n=r[c],a=n.join(String.fromCharCode(0)),o=[];for(e in s)!function(){var r=s[e],t=r.join(String.fromCharCode(0));0!==n.length&&(i.rowTotals[a]||(i.rowKeys.push(n),i.rowTotals[a]=i.aggregator.map(function(t){return t(i,n,[])})),i.rowTotals[a].forEach(function(t,e){if(!i.grouping||1===r.length)return t.push(l)})),0!==r.length&&(i.colTotals[t]||(i.colKeys.push(r),i.colTotals[t]=i.aggregator.map(function(t){return t(i,[],r)})),i.colTotals[t].forEach(function(t,e){if(!i.grouping||1===n.length)return t.push(l)})),0!==r.length&&0!==n.length?(i.tree[a]||(i.tree[a]={}),i.tree[a][t]||(i.tree[a][t]=i.aggregator.map(function(t){return t(i,n,r)})),o.push(i.tree[a][t].forEach(function(t,e){return t.push(l)}))):o.push(void 0)}();d.push(o)}var c,d=[];for(c in r)u();return d}},{key:"getAggregator",value:function(t,e,r){null==r&&(r=0);var n=t.join(String.fromCharCode(0)),a=e.join(String.fromCharCode(0)),t=0===t.length&&0===e.length?this.allTotal[r]:0===t.length?this.colTotals[a]&&this.colTotals[a][r]:0===e.length?this.rowTotals[n]&&this.rowTotals[n][r]:this.tree[n][a]&&this.tree[n][a][r];return null!=t?t:{value:function(){return null},format:function(){return""}}}}],[{key:"forEachRecord",value:function(t,n,a){var r,o=st.isEmptyObject(n)?a:function(t){for(var e in n){var r=(0,n[e])(t);null!=r&&(t[e]=r)}return a(t)};if(st.isFunction(t))return t(o);if(st.isArray(t)){if(st.isArray(t[0])){for(var e=[],l=0,i=Object.keys(t||{});l<i.length;l++){var s=i[l],u=t[s];if(0<s){for(var c={},d=0,p=Object.keys(t[0]||{});d<p.length;d++){var h=p[d];c[t[0][h]]=u[h]}e.push(o(c))}}return e}var f,g=[],v=_createForOfIteratorHelper(t);try{for(v.s();!(f=v.n()).done;){var m=f.value;g.push(o(m))}}catch(t){v.e(t)}finally{v.f()}return g}if(t instanceof st)return r=[],st("thead > tr > th",t).each(function(t){return r.push(st(this).text())}),st("tbody > tr",t).each(function(t){var e={};return st("td",this).each(function(t){return e[r[t]]=st(this).text()}),o(e)});throw new Error("unknown input format")}}])}();function v(c,d){d=st.extend(!0,{},{table:{clickCallback:null,rowTotals:!0,colTotals:!0},localeStrings:{totals:"Totals"}},d);for(var t,e,r,n,a,o,l,p=c.colAttrs,h=c.rowAttrs,i=c.getRowKeys(!0),s=c.getColKeys(!0),u=(d.table.clickCallback&&(e=function(e,t,r){for(var n,a,o={},l=0,i=Object.keys(p||{});l<i.length;l++)a=i[l],n=p[a],null!=r[a]&&(o[n]=r[a]);for(var s=0,u=Object.keys(h||{});s<u.length;s++)a=u[s],n=h[a],null!=t[a]&&(o[n]=t[a]);return function(t){return d.table.clickCallback(t,e,o,c)}}),(null==d.table.compactLayout||d.table.compactLayout)&&c.grouping),f=u?Z:c.rowGroupBefore?X:rt,M=tt(i,!0,f.bind(c)),R=tt(s,!1,X.bind(c)),f=document.createElement("table"),g=(f.className="pvtTable",function(t,e,r){if(0!==e){for(var n=!0,a=0,o=r,l=0<=o;l?a<=o:o<=a;l?a++:a--)t[e-1][a]!==t[e][a]&&(n=!1);if(n)return-1}for(var i=0;e+i<t.length;){for(var s,u=!1,c=(a=0)<=(s=r);c?a<=s:s<=a;c?a++:a--)t[e][a]!==t[e+i][a]&&(u=!0);if(u)break;i++}return i}),v=document.createElement("thead"),m=0,K=Object.keys(p||{});m<K.length;m++){var b=K[m],U=p[b],y=document.createElement("tr");0===parseInt(b)&&0!==h.length&&((w=document.createElement("th")).setAttribute("colspan",h.length),w.setAttribute("rowspan",p.length),y.appendChild(w)),(w=document.createElement("th")).className="pvtAxisLabel",w.textContent=U,c.grouping&&b<p.length-1&&(w.onclick=et(c,+b,!1),w.className+=" open level".concat(b)),y.appendChild(w);for(var C=0,B=Object.keys(s||{});C<B.length;C++)N=s[_=B[C]],-1!==(l=g(s,parseInt(_),parseInt(b)))&&((w=document.createElement("th")).className="pvtColLabel",w.className+=" col".concat(c.colGroupBefore?+_:+_+l-1),w.textContent=N[b],w.setAttribute("colspan",l*Math.max(1,c.aggregator.length)),parseInt(b)===p.length-1&&0!==h.length&&w.setAttribute("rowspan",2),c.grouping&&b<p.length-1&&N[b]&&(w.className+=" pvtSubtotal open",w.setAttribute("colspan",l*Math.max(1,c.aggregator.length)),w.onclick=R),y.appendChild(w));0===parseInt(b)&&d.table.rowTotals&&((w=document.createElement("th")).className="pvtTotalLabel pvtRowTotalLabel",w.innerHTML=d.localeStrings.totals,w.setAttribute("colspan",Math.max(1,c.aggregator.length)),w.setAttribute("rowspan",p.length+(0===h.length?0:1)),y.appendChild(w)),v.appendChild(y)}if(0!==h.length){y=document.createElement("tr");for(var A=0,P=Object.keys(h||{});A<P.length;A++){var w,_=P[A],H=h[_];(w=document.createElement("th")).className="pvtAxisLabel",w.textContent=H,c.grouping&&_<h.length-1&&(w.className+=" open level".concat(_),w.onclick=et(c,+_,!0)),y.appendChild(w)}w=document.createElement("th"),0===p.length&&(w.className="pvtTotalLabel pvtRowTotalLabel",w.innerHTML=d.localeStrings.totals,w.setAttribute("colspan",c.aggregator.length)),y.appendChild(w),v.appendChild(y)}f.appendChild(v);var T=document.createElement("tbody");if(c.aggregatorsLabel&&1<c.aggregatorsLabel.length){y=document.createElement("tr"),w=document.createElement("th");var S,V=h.length+(0===p.length?0:1);w.setAttribute("colspan",V),y.appendChild(w);for(var x=0,q=Object.keys(s||{});x<q.length;x++){var z,N=s[b=q[x]],k=_createForOfIteratorHelper(c.aggregatorsLabel);try{for(k.s();!(z=k.n()).done;)S=z.value,(w=document.createElement("th")).className="pvtAggregatorLabel col".concat(b),w.textContent=S,y.appendChild(w)}catch(t){k.e(t)}finally{k.f()}}var G,O=_createForOfIteratorHelper(c.aggregatorsLabel);try{for(O.s();!(G=O.n()).done;)S=G.value,(w=document.createElement("th")).className="pvtAggregatorLabel",w.textContent=S,y.appendChild(w)}catch(t){O.e(t)}finally{O.f()}T.appendChild(y)}for(var L=0,W=Object.keys(i||{});L<W.length;L++){var I=i[_=W[L]],F=(y=document.createElement("tr"),h.length-I.length);y.className=F?"pvtSubtotal level".concat(I.length):"pvtData";for(var D=0,J=Object.keys(I||{});D<J.length;D++){var $=I[b=J[D]];u&&b<I.length-1||-1!==(l=u?1:g(i,parseInt(_),parseInt(b)))&&((w=document.createElement("th")).className="pvtRowLabel",w.className+=" row".concat(c.rowGroupBefore?+_:+_+l-1),w.textContent=$,w.setAttribute("rowspan",l),u&&(w.colSpan=h.length,w.style.paddingLeft=5+20*parseInt(b)+"px"),c.grouping&&b<h.length-1&&(w.className+=" open",w.onclick=M),y.appendChild(w))}!u&&F&&((w=document.createElement("th")).colSpan=F,w.textContent="Total (".concat(I[b],")"),y.appendChild(w)),p.length&&w.colSpan++;for(var E=0,Q=Object.keys(s||{});E<Q.length;E++)for(N=s[b=Q[E]],r=0;r<c.aggregator.length;r++)c.aggregator[r],o=(t=c.getAggregator(I,N,r)).value(r),n=document.createElement("td"),F||(n.className="pvtVal "),n.className+="row".concat(_," col").concat(b),p.length-N.length&&(n.className="pvtSubtotal level".concat(N.length," row").concat(_," col").concat(b)),n.textContent=t.format(o),n.setAttribute("data-value",o),null!=e&&(n.onclick=e(o,I,N)),y.appendChild(n);if(d.table.rowTotals||0===p.length)for(r=0;r<c.aggregator.length;r++)c.aggregator[r],o=(a=c.getAggregator(I,[],r)).value(r),(n=document.createElement("td")).className="pvtTotal rowTotal",n.textContent=a.format(o),n.setAttribute("data-value",o),null!=e&&(n.onclick=e(o,I,[])),n.setAttribute("data-for","row"+_),y.appendChild(n);T.appendChild(y)}if(d.table.colTotals||0===h.length){y=document.createElement("tr"),!d.table.colTotals&&0!==h.length||((w=document.createElement("th")).className="pvtTotalLabel pvtColTotalLabel",w.innerHTML=d.localeStrings.totals,w.setAttribute("colspan",h.length+(0===p.length?0:1)),y.appendChild(w));for(var j=0,Y=Object.keys(s||{});j<Y.length;j++)for(N=s[b=Y[j]],r=0;r<c.aggregator.length;r++)c.aggregator[r],o=(a=c.getAggregator([],N,r)).value(r),(n=document.createElement("td")).className="pvtTotal colTotal col".concat(b),N.length!==p.length&&(n.className+=" pvtSubtotal level".concat(N.length)),n.textContent=a.format(o),n.setAttribute("data-value",o),null!=e&&(n.onclick=e(o,[],N)),n.setAttribute("data-for","col"+b),y.appendChild(n);if(d.table.rowTotals||0===p.length)for(r=0;r<c.aggregator.length;r++)c.aggregator[r],o=(a=c.getAggregator([],[],r)).value(r),(n=document.createElement("td")).className="pvtGrandTotal",n.textContent=a.format(o),n.setAttribute("data-value",o),null!=e&&(n.onclick=e(o,[],[])),y.appendChild(n);T.appendChild(y)}return f.appendChild(T),f.setAttribute("data-numrows",i.length),f.setAttribute("data-numcols",s.length),f}st.pivotUtilities={aggregatorTemplates:s,aggregators:ct,renderers:a,derivers:S,locales:dt,naturalSort:pt,numberFormat:t,sortAs:function(t){var e,r={},n={};for(e in t){var a=t[e];r[a]=e,"string"==typeof a&&(n[a.toLowerCase()]=e)}return function(t,e){return null!=r[t]&&null!=r[e]?r[t]-r[e]:null!=r[t]?-1:null!=r[e]?1:null!=n[t]&&null!=n[e]?n[t]-n[e]:null!=n[t]?-1:null!=n[e]?1:pt(t,e)}},PivotData:gt},st.fn.pivot=function(t,e,r){null==dt[r=null==r?"en":r]&&(r="en"),e=e||{};var n,a,o={cols:[],rows:[],vals:[],rowOrder:"key_a_to_z",colOrder:"key_a_to_z",dataClass:gt,filter:function(){return!0},aggregator:s.count()(),aggregatorName:"Count",sorters:{},derivedAttributes:{},renderer:v},r=st.extend(!0,{},dt.en.localeStrings,dt[r].localeStrings),r=st.extend(!0,{},{rendererOptions:{localeStrings:r},localeStrings:r},st.extend({},o,e));e.pivotData=null;try{var l=new r.dataClass(t,r);try{a=r.renderer(l,r.rendererOptions),e.pivotData=l}catch(t){n=t,"undefined"!=typeof console&&null!==console&&console.error(n.stack),a=st("<span>").html(r.localeStrings.renderError)}}catch(t){n=t,"undefined"!=typeof console&&null!==console&&console.error(n.stack),a=st("<span>").html(r.localeStrings.computeError)}for(var i=this[0];i.hasChildNodes();)i.removeChild(i.lastChild);return this.append(a)},st.fn.pivotUI=function(M,t,e,m){var r,n,b=this,R=(null==e&&(e=!1),{derivedAttributes:{},aggregators:ct,renderers:dt[m=null==dt[m=null==m?"fr":m]?"en":m].renderers,hiddenAttributes:[],hiddenFromAggregators:[],hiddenFromDragDrop:[],menuLimit:500,cols:[],rows:[],vals:[],rowOrder:"key_a_to_z",colOrder:"key_a_to_z",dataClass:gt,exclusions:{},inclusions:{},unusedAttrsVertical:85,autoSortUnusedAttrs:!1,onRefresh:null,showUI:!0,filter:function(){return!0},sorters:{},multiple:!0,parametersActive:!1}),a=0,y=[],o=st.extend(!0,{},dt.en.localeStrings,dt[m].localeStrings),K={rendererOptions:{localeStrings:o},localeStrings:o},U=this.data("pivotUIOptions"),C=null==U||e?st.extend(!0,{},K,st.extend({},R,t)):U;null!=t&&t.aggregators||!dt[m].formatters||(C.aggregators=ut(dt[m].formatters.format,dt[m].formatters.formatInt,dt[m].formatters.formatPct));try{for(var A,w,_,v={},B=[],l=0,P=(gt.forEachRecord(M,C.derivedAttributes,function(t){if(C.filter(t)){B.push(t);for(var e=0,r=Object.keys(t||{});e<r.length;e++)n=r[e],null==v[n]&&(v[n]={},0<l)&&(v[n].null=l);for(var n in v){var a=null!=t[n]?t[n]:"null";null==v[n][a]&&(v[n][a]=0),v[n][a]++}return l++}}),st("<div>").addClass("pvtUi")),i=st("<div>").addClass("pvtUiMenu"),s=st("<div>").addClass("pvtUiParameters"),H=st("<div>").addClass("pvtUiContainer"),u=st("<div>").addClass("pvtUiVerticalButton").addClass("pvtUiButtonColumns").addClass("active").text(o.colsLabel).on("click",function(){return C.parametersActive=!C.parametersActive,C.parametersActive?(u.addClass("active"),s.show()):(u.removeClass("active"),s.hide())}).appendTo(i),V=st("<div>").addClass("pvtUiVerticalButton").addClass("pvtUiButtonGroups").text(o.groupsLabel).on("click",function(){return C.grouping?(V.removeClass("active"),C.grouping=!1):(V.addClass("active"),C.grouping={colGroupBefore:!1}),F()}).appendTo(i),q=(P.append(i).append(s).append(H),st("<div>").addClass("pvtParameterLabel").appendTo(s).text(o.rendererLabel),st("<div>").addClass("pvtRendererType").addClass("pvtParameter").appendTo(s)),c=st("<select>").addClass("pvtRenderer").appendTo(q).bind("change",function(){return F()}),d=0,z=Object.keys(C.renderers||{});d<z.length;d++)_=z[d],st("<option>").val(_).html(_).appendTo(c);var G=st("<div>").addClass("pvtAxisContainer pvtUnused"),p=[];for(r in v)C.hiddenAttributes.includes(r)||p.push(r);for(var W=[],h=0,J=p;h<J.length;h++)n=J[h],C.hiddenFromAggregators.includes(n)||W.push(n);for(var T=[],f=0,$=p;f<$.length;f++)n=$[f],C.hiddenFromDragDrop.includes(n)||T.push(n);var Q="auto"===C.unusedAttrsVertical?120:parseInt(C.unusedAttrsVertical);if(!isNaN(Q)){var Y,g=_createForOfIteratorHelper(T);try{for(g.s();!(Y=g.n()).done;)(r=Y.value).length}catch(t){g.e(t)}finally{g.f()}0}for(var X=function(){w=Z[S],A=T[w];var t,e=[];for(t in v[A])e.push(t);var r=!1,n=st("<div>").addClass("pvtFilterBox").hide();if(n.append(st("<h4>").append(st("<span>").text(A),st("<span>").addClass("count").text("(".concat(e.length,")")))),e.length>C.menuLimit)n.append(st("<p>").html(C.localeStrings.tooMany));else{5<e.length&&(f=st("<p>").appendTo(n),o=ht(C.sorters,A),h=C.localeStrings.filterResults,st("<input>",{type:"text"}).appendTo(f).attr({placeholder:h,class:"pvtSearch"}).bind("keyup",function(){function t(r,n){return function(t){var e=a.substring(r.length).trim();return 0===e.length||(t=Math.sign(o(t.toLowerCase(),e)),n.includes(t))}}var a=st(this).val().toLowerCase().trim(),e=0===a.indexOf(">=")?t(">=",[1,0]):0===a.indexOf("<=")?t("<=",[-1,0]):0===a.indexOf(">")?t(">",[1]):0===a.indexOf("<")?t("<",[-1]):0===a.indexOf("~")?function(t){return 0===a.substring(1).trim().length||t.toLowerCase().match(a.substring(1))}:function(t){return-1!==t.toLowerCase().indexOf(a)};return n.find(".pvtCheckContainer p label span.value").each(function(){return e(st(this).text())?st(this).parent().parent().show():st(this).parent().parent().hide()})}),f.append(st("<br>")),st("<button>",{type:"button"}).appendTo(f).html(C.localeStrings.selectAll).bind("click",function(){return n.find("input:visible:not(:checked)").prop("checked",!0).toggleClass("changed"),!1}),st("<button>",{type:"button"}).appendTo(f).html(C.localeStrings.selectNone).bind("click",function(){return n.find("input:visible:checked").prop("checked",!1).toggleClass("changed"),!1}));var o,a,l=st("<div>").addClass("pvtCheckContainer").appendTo(n),i=_createForOfIteratorHelper(e.sort(ht(C.sorters,A)));try{for(i.s();!(a=i.n()).done;){var s=a.value,u=v[A][s],c=st("<label>"),d=!1;C.inclusions[A]?d=!C.inclusions[A].includes(s):C.exclusions[A]&&(d=C.exclusions[A].includes(s)),r=r||d,st("<input>").attr("type","checkbox").addClass("pvtFilter").attr("checked",!d).data("filter",[A,s]).appendTo(c).bind("change",function(){return st(this).toggleClass("changed")}),c.append(st("<span>").addClass("value").text(s)),c.append(st("<span>").addClass("count").text("("+u+")")),l.append(st("<p>").append(c))}}catch(t){i.e(t)}finally{i.f()}}function p(){return n.find("[type='checkbox']").length>n.find("[type='checkbox']:checked").length?g.addClass("pvtFilteredAttribute"):g.removeClass("pvtFilteredAttribute"),n.find(".pvtSearch").val(""),n.find(".pvtCheckContainer p").show(),n.hide()}var h=st("<p>").appendTo(n),f=(e.length<=C.menuLimit&&st("<button>",{type:"button"}).text(C.localeStrings.apply).appendTo(h).bind("click",function(){return n.find(".changed").removeClass("changed").length&&F(),p()}),st("<button>",{type:"button"}).text(C.localeStrings.cancel).appendTo(h).bind("click",function(){return n.find(".changed:checked").removeClass("changed").prop("checked",!1),n.find(".changed:not(:checked)").removeClass("changed").prop("checked",!0),p()}),st("<span>").addClass("pvtTriangle").html(" &#x25BE;").bind("click",function(t){var t=st(t.currentTarget).position(),e=t.left,t=t.top;return n.css({left:e+10,top:t+10}).show()})),g=st("<li>").addClass("axis_".concat(w)).append(st("<span>").addClass("pvtAttr").text(A).data("attrName",A).append(f));r&&g.addClass("pvtFilteredAttribute"),G.append(g).append(n)},S=0,Z=Object.keys(T||{});S<Z.length;S++)X();st("<div>").addClass("pvtParameterLabel").appendTo(s).text(o.valuesLabel);for(var x=st("<div>").addClass("pvtAggregatorChoose").addClass("pvtParameter").appendTo(s),N=st("<select>").addClass("pvtAggregator").appendTo(x).bind("change",function(){if(!C.multiple)return b.find(".pvtVals .pvtAttrDropdown").each(function(){return this.remove()}),y=[{id:1,value:N.val()}],F()}),k=0,tt=Object.keys(C.aggregators||{});k<tt.length;k++)_=tt[k],N.append(st("<option>").val(_).html(dt[m].localeStrings[_]||dt.en.localeStrings[_]||_));C.multiple&&st("<a>",{role:"button"}).addClass("pvtAddAggregator").addClass("pvtToolButton").appendTo(x).html("+").bind("click",function(){return y.push({id:++a,value:N.val()}),ft(y),F()});var et,O={key_a_to_z:{rowSymbol:"&varr;",colSymbol:"&harr;",next:"value_a_to_z"},value_a_to_z:{rowSymbol:"&darr;",colSymbol:"&rarr;",next:"value_z_to_a"},value_z_to_a:{rowSymbol:"&uarr;",colSymbol:"&larr;",next:"key_a_to_z"}},rt=st("<a>",{role:"button"}).addClass("pvtRowOrder").addClass("pvtToolButton").appendTo(x).data("order",C.rowOrder).html(O[C.rowOrder].rowSymbol).bind("click",function(){return st(this).data("order",O[st(this).data("order")].next),st(this).html(O[st(this).data("order")].rowSymbol),F()}),nt=st("<a>",{role:"button"}).addClass("pvtColOrder").addClass("pvtToolButton").appendTo(x).data("order",C.colOrder).html(O[C.colOrder].colSymbol).bind("click",function(){return st(this).data("order",O[st(this).data("order")].next),st(this).html(O[st(this).data("order")].colSymbol),F()}),at=st("<div>").addClass("pvtVals").addClass("pvtParameter").appendTo(s),L=(s.append(at),st("<div>").addClass("pvtParameterLabel").appendTo(s).text(o.fieldsLabel),s.append(G),st("<div>").addClass("pvtParameterLabel").appendTo(s).text(o.colsLabel),st("<div>").addClass("pvtAxisContainer pvtCols").appendTo(s),st("<div>").addClass("pvtParameterLabel").appendTo(s).text(o.rowsLabel),st("<div>").addClass("pvtAxisContainer pvtRows").appendTo(s),st("<div>").addClass("pvtRendererArea").appendTo(H)),I=(this.html(P),C.parametersActive||(u.removeClass("active"),s.hide()),!0),ot=function(){for(var h,t={derivedAttributes:C.derivedAttributes,localeStrings:C.localeStrings,rendererOptions:C.rendererOptions,sorters:C.sorters,cols:[],rows:[],dataClass:C.dataClass,grouping:C.grouping},f=(b.find(".pvtRows li span.pvtAttr").each(function(){return t.rows.push(st(this).data("attrName"))}),b.find(".pvtCols li span.pvtAttr").each(function(){return t.cols.push(st(this).data("attrName"))}),0),g=[],e=0,v=e;e<y.length;v=++e)!function(){var t,e,r=y[v],n=("object"===_typeof(r)&&(t=r.value),r.id),a=r.vals,o=C.aggregators[t]([])().numInputs,o=(f=null!=o?o:0,h=[],b.find(".pvtVals select.pvtAttrDropdown"+n).each(function(){if(0!==f&&(f--,""!==st(this).val()))return h.push(st(this).val())}),b.find(".pvtVals")),l=b.find(".pvtVals .pvtAttrDropdownContainer"+n),i=0<l.length;if(C.multiple?(i||(l=st("<div>").addClass("pvtAttrDropdownContainer").addClass("pvtAttrDropdownContainer"+n).appendTo(o),e=dt[m].localeStrings[t]||dt.en.localeStrings[t]||t,st("<label>").addClass("pvtAttrDropdown").addClass("pvtAttrDropdown"+n).appendTo(l).html("<b>"+r.displayName+"</b>) "+e),I=!0),I||b.find(".pvtVals .pvtAttrDropdownContainer"+n+" label.pvtAttrDropdown").each(function(){return e=dt[m].localeStrings[t]||dt.en.localeStrings[t]||t,st(this).html("<b>"+r.displayName+"</b>) "+e)})):l=o,0!==f)for(var s,u=(_=0)<=(s=f);u?_<s:s<_;u?_++:_--){for(var c=st("<select>").addClass("pvtAttrDropdown"+n).addClass("pvtAttrDropdown").append(st("<option>")).bind("change",function(){return F()}),d=0,p=W;d<p.length;d++)A=p[d],c.append(st("<option>").val(A).text(A));l.append(c)}C.multiple&&!i&&st("<a>").html("x").addClass("pvtRemoveAggregator").addClass("pvtToolButton").addClass("pvtAttrDropdown"+n).appendTo(l).bind("click",function(){var e=this;return this.instance.find(".pvtVals .pvtAttrDropdownContainer"+this.aggIdx).remove(),v=y.findIndex(function(t){return t.id===e.aggIdx}),y.splice(v,1),ft(y),F()}.bind({instance:b,aggIdx:n})),I&&(h=null!=a?a:C.vals,w=0,b.find(".pvtVals select.pvtAttrDropdown"+n).each(function(){return st(this).val(h[w]),w++}),I=!1),g.push(h)}();t.aggregatorName=y.map(function(t){return t.value}),t.vals=g,t.aggregator=y.map(function(t,e){return C.aggregators[t.value](g[e])}),t.renderer=C.renderers[c.val()],t.rowOrder=rt.data("order"),t.colOrder=nt.data("order"),C.multiple&&(t.aggregatorsLabel=y.map(function(t){return t.displayName}));var r,n={},a=(b.find("input.pvtFilter").not(":checked").each(function(){var t=st(this).data("filter");return null!=n[t[0]]?n[t[0]].push(t[1]):n[t[0]]=[t[1]]}),{}),o=(b.find("input.pvtFilter:checked").each(function(){var t=st(this).data("filter");if(null!=n[t[0]])return null!=a[t[0]]?a[t[0]].push(t[1]):a[t[0]]=[t[1]]}),t.filter=function(t){if(!C.filter(t))return!1;for(var e in n)if(n[e].includes(""+(null!=t[e]?t[e]:"null")))return!1;return!0},L.pivot(B,t),st.extend({},C,{cols:t.cols,rows:t.rows,colOrder:t.colOrder,rowOrder:t.rowOrder,vals:g,exclusions:n,inclusions:a,aggregator:t.aggregator,inclusionsInfo:a,aggregatorName:t.aggregatorName,rendererName:c.val()})),l=t.pivotData;if(delete t.pivotData,b.data("pivotUIOptions",o),C.autoSortUnusedAttrs&&(r=b.find("td.pvtUnused.pvtAxisContainer"),st(r).children("li").sort(function(t,e){return pt(st(t).text(),st(e).text())}).appendTo(r)),L.css("opacity",1),null!=C.onRefresh)return C.onRefresh(o,l)},F=function(){return L.css("opacity",.5),setTimeout(ot,10)},D=_createForOfIteratorHelper(C.cols);try{for(D.s();!(et=D.n()).done;)_=et.value,this.find(".pvtCols").append(this.find(".axis_".concat(st.inArray(_,T))))}catch(t){D.e(t)}finally{D.f()}var lt,E=_createForOfIteratorHelper(C.rows);try{for(E.s();!(lt=E.n()).done;)_=lt.value,this.find(".pvtRows").append(this.find(".axis_".concat(st.inArray(_,T))))}catch(t){E.e(t)}finally{E.f()}if(null!=C.aggregatorName)if(C.multiple){C.aggregatorName=Array.isArray(C.aggregatorName)?C.aggregatorName:[C.aggregatorName];for(var j=0;j<C.aggregatorName.length;j++){var it=C.aggregatorName[j];y.push({id:++a,value:it,vals:null!=C.vals?C.vals[j]:void 0}),ft(y)}}else this.find(".pvtVals").append(this.find(".pvtAttrDropdown")),this.find(".pvtAggregator").val(C.aggregatorName).change();else this.find(".pvtAggregator").change();null!=C.rendererName&&this.find(".pvtRenderer").val(C.rendererName),C.showUI||this.find(".pvtUiCell").hide(),F(),this.find(".pvtAxisContainer").sortable({update:function(t,e){if(null==e.sender)return F()},connectWith:this.find(".pvtAxisContainer"),items:"li",placeholder:"pvtPlaceholder"})}catch(t){console.error(t),this.html(C.localeStrings.uiRenderError)}return this},st.fn.heatmap=function(t,e){function r(t){function e(e){return a.find(t).each(function(){var t=st(this).data("value");if(null!=t&&isFinite(t))return e(t,st(this))})}var r=[],n=(e(function(t){return r.push(t)}),l(r));e(function(t,e){return e.css("background-color",n(t))})}var a=this,n=(null==t&&(t="heatmap"),this.data("numrows")),o=this.data("numcols"),l=null==e||null==(e=e.heatmap)?void 0:e.colorScaleGenerator;null==l&&(l=function(t){var e=Math.min.apply(Math,_toConsumableArray(t||[])),r=Math.max.apply(Math,_toConsumableArray(t||[]));return function(t){t=255-Math.round(255*(t-e)/(r-e));return"rgb(255,".concat(t,",").concat(t,")")}});switch(t){case"heatmap":r(".pvtVal");break;case"rowheatmap":for(var i=0,s=n,u=0<=s;u?i<s:s<i;u?i++:i--)r(".pvtVal.row".concat(i));break;case"colheatmap":for(var c=0,d=o,p=0<=d;p?c<d:d<c;p?c++:c--)r(".pvtVal.col".concat(c))}return r(".pvtTotal.rowTotal"),r(".pvtTotal.colTotal"),this},st.fn.barchart=function(t){for(var o=this,e=this.data("numrows"),r=(this.data("numcols"),function(t){function e(e){return o.find(t).each(function(){var t=st(this).data("value");if(null!=t&&isFinite(t))return e(t,st(this))})}function l(t){return 100*t/(1.4*a)}var r=[],n=(e(function(t){return r.push(t)}),Math.max.apply(Math,_toConsumableArray(r||[]))),a=n=n<0?0:n,i=Math.min.apply(Math,_toConsumableArray(r||[]));i<0&&(a=n-i);return e(function(t,e){var r=e.text(),n=st("<div>").css({position:"relative",height:"55px"}),a="gray",o=0;return i<0&&(o=l(-i)),t<0&&(o+=l(t),a="darkred",t=-t),n.append(st("<div>").css({position:"absolute",bottom:o+"%",left:0,right:0,height:l(t)+"%","background-color":a})),n.append(st("<div>").text(r).css({position:"relative","padding-left":"5px","padding-right":"5px"})),e.css({padding:0,"padding-top":"5px","text-align":"center"}).html(n)})}),n=0,a=e,l=0<=a;l?n<a:a<n;l?n++:n--)r(".pvtVal.row".concat(n));return r(".pvtTotal.colTotal"),this};function m(t){return Array.prototype.indexOf.call(t.parentNode.children,t)}function b(t){var e=t.find("tbody tr");return function(t){return st(e[t])}}function y(t,e,r,n,a){var o,l=x(e,r);for(o in l){var i=l[o],s=t(i+n);(a?st.fn.show:st.fn.hide).call(s),s.hasClass("collapsed")||y(t,e,i,n,a)}return!0}function C(t,e,r,n,a){a&&1<r&&(w(e,n,r-1).removeClass("close").addClass("open"),C(t,e,r-1,n,a));var o=(n?t.rowAttrs:t.colAttrs).length-1;if(!a&&r<o)for(var l=r+1,i=l,s=o,u=l<=s;u?i<=s:s<=i;u?i++:i--)w(e,n,i).removeClass("open").addClass("close");var o=n?t.rowKeys:t.colKeys,c=N(o,r);for(i in c){var d=c[i],d=_(e,n,d);a===d.hasClass("close")&&d.trigger("click")}return null}var x=function(t,e){for(var r=1===t[0].length?1:-1,n=t[e].length,a=[],o=t[e+=r];o&&o.length>n;)o.length===n+1&&(a.push(e),o=t[e+=r]);return a},A=function(t,e){for(var r=1===t[0].length?1:-1,n=[],a=t[e].length;1<a;){for(var o=void 0,o=t[e-=r];o&&o.length>=a;)o=t[e-=r];n.push(e),a=t[e].length}return n},N=function(t,e){return t.filter(function(t){return t.length===e}).map(t.indexOf.bind(t))},w=function(t,e,r){return e?t.find("thead tr:last-child th.pvtAxisLabel:nth-of-type(".concat(r,")")):t.find("thead tr:nth-child(".concat(r,") th.pvtAxisLabel"))},_=function(t,e,r){return t.find((e?"tbody tr th.row":"thead th.col").concat(r))},rt=function(t,e,r,n){var a,o=st(t).closest("table"),l=m(t.parentNode),i=b(o),s=i(n),u=s.hasClass("collapsed")?i(t._old):s,c=(s.hasClass("collapsed")||(t._old=m(t.parentNode)),u.prepend(t),A(r,n));for(a in c){var d=c[a],d=_(o,e,d)[0],p=m(d.parentNode);d._old=null!=d._old?d._old:p,d._old===l&&1===d.rowSpan&&(d._old-=l-m(t.parentNode)),l===p&&u.prepend(d)}return X(t,e,r,n)},Z=function(t,e,r,n,a){var o,l=st(t).closest("table"),l=e?b(l):(o=l.find("tr"),function(t){return o.find(".col".concat(t))}),i=e&&1<this.aggregator.length?1:0;return 1!==(null!=a?a[e?"rowSpan":"colSpan"]:void 0)&&y(l,r,n,i,l(n+i).hasClass("collapsed")),l(n+i).toggleClass("collapsed"),st(t).toggleClass("open close")},tt=function(r,n,a){return function(t){var e=t.target.className.match(n?/row(\d+)/:/col(\d+)/);if(e)return a(t.target,n,r,+e[1])}},et=function(e,r,n){return function(t){return C(e,st(t.target).closest("table"),r+1,n,st(t.target).hasClass("close")),st(t.target).toggleClass("open close")}}}(jQuery);
//# sourceMappingURL=pivot.min.js.map
