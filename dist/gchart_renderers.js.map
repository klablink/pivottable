{"version":3,"file":"gchart_renderers.js","names":["$","makeGoogleChart","chartType","extraOptions","pivotData","opts","agg","dataArray","dataTable","hAxisTitle","title","vAxisTitle","defaults","localeStrings","vs","by","gchart","extend","width","window","innerWidth","height","innerHeight","rowKeys","getRowKeys","length","push","colKeys","getColKeys","fullAggName","aggregatorName","valAttrs","concat","join","headers","Array","from","map","h","unshift","numCharsInHAxis","y","tree","tree2","x","parseFloat","format","value","google","visualization","DataTable","addColumn","colAttrs","rowAttrs","type","role","addRows","_i","_Array$from","colKey","row","_i2","_Array$from2","rowKey","getAggregator","val","isNumeric","toPrecision","toFixed","arrayToDataTable","groupByTitle","options","hAxis","slantedText","vAxis","tooltip","textStyle","fontName","fontSize","minValue","legend","position","chartArea","result","css","wrapper","ChartWrapper","draw","bind","editor","ChartEditor","events","addListener","getChartWrapper","openDialog","pivotUtilities","gchart_renderers","isStacked","jQuery"],"sources":["gchart_renderers.js"],"sourcesContent":["// TODO: This file was created by bulk-decaffeinate.\n// Sanity-check the conversion and remove this comment.\n/*\n * decaffeinate suggestions:\n * DS101: Remove unnecessary use of Array.from\n * DS102: Remove unnecessary code created because of implicit returns\n * DS207: Consider shorter variations of null checks\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/main/docs/suggestions.md\n */\n\n(function($) {\n\n    const makeGoogleChart = (chartType, extraOptions) => (function(pivotData, opts) {\n        let agg, dataArray, dataTable, hAxisTitle, title, vAxisTitle;\n        const defaults = {\n            localeStrings: {\n                vs: \"vs\",\n                by: \"by\"\n            },\n            gchart: {}\n        };\n\n        opts = $.extend(true, {}, defaults, opts);\n        if (opts.gchart.width == null) { opts.gchart.width = window.innerWidth / 1.4; }\n        if (opts.gchart.height == null) { opts.gchart.height = window.innerHeight / 1.4; }\n\n        const rowKeys = pivotData.getRowKeys();\n        if (rowKeys.length === 0) { rowKeys.push([]); }\n        const colKeys = pivotData.getColKeys();\n        if (colKeys.length === 0) { colKeys.push([]); }\n        let fullAggName = pivotData.aggregatorName;\n        if (pivotData.valAttrs.length) {\n            fullAggName += `(${pivotData.valAttrs.join(\", \")})`;\n        }\n        const headers = (Array.from(rowKeys).map((h) => h.join(\"-\")));\n        headers.unshift(\"\");\n\n        let numCharsInHAxis = 0;\n        if (chartType === \"ScatterChart\") {\n            dataArray = [];\n            for (var y in pivotData.tree) {\n                var tree2 = pivotData.tree[y];\n                for (var x in tree2) {\n                    agg = tree2[x];\n                     dataArray.push([\n                        parseFloat(x),\n                        parseFloat(y),\n                        fullAggName+\": \\n\"+agg.format(agg.value())\n                        ]);\n                }\n            }\n            dataTable = new google.visualization.DataTable();\n            dataTable.addColumn('number', pivotData.colAttrs.join(\"-\"));\n            dataTable.addColumn('number', pivotData.rowAttrs.join(\"-\"));\n            dataTable.addColumn({type: \"string\", role: \"tooltip\"});\n            dataTable.addRows(dataArray);\n            hAxisTitle = pivotData.colAttrs.join(\"-\");\n            vAxisTitle = pivotData.rowAttrs.join(\"-\");\n            title = \"\";\n        } else {\n            dataArray = [headers];\n            for (var colKey of Array.from(colKeys)) {\n                var row = [colKey.join(\"-\")];\n                numCharsInHAxis += row[0].length;\n                for (var rowKey of Array.from(rowKeys)) {\n                    agg = pivotData.getAggregator(rowKey, colKey);\n                    if (agg.value() != null) {\n                        var val = agg.value();\n                        if ($.isNumeric(val)) {\n                            if (val < 1) {\n                                row.push(parseFloat(val.toPrecision(3)));\n                            } else {\n                                row.push(parseFloat(val.toFixed(3)));\n                            }\n                        } else {\n                            row.push(val);\n                        }\n                    } else { row.push(null); }\n                }\n                dataArray.push(row);\n            }\n\n            dataTable = google.visualization.arrayToDataTable(dataArray);\n\n            title = (vAxisTitle = fullAggName);\n            hAxisTitle = pivotData.colAttrs.join(\"-\");\n            if (hAxisTitle !== \"\") { title += ` ${opts.localeStrings.vs} ${hAxisTitle}`; }\n            const groupByTitle = pivotData.rowAttrs.join(\"-\");\n            if (groupByTitle !== \"\") { title += ` ${opts.localeStrings.by} ${groupByTitle}`; }\n        }\n\n        let options = {\n            title,\n            hAxis: {title: hAxisTitle, slantedText: numCharsInHAxis > 50},\n            vAxis: {title: vAxisTitle},\n            tooltip: { textStyle: { fontName: 'Arial', fontSize: 12 } }\n        };\n\n        if (chartType === \"ColumnChart\") {\n            options.vAxis.minValue = 0;\n        }\n\n        if (chartType === \"ScatterChart\") {\n            options.legend = {position: \"none\"};\n            options.chartArea = {'width': '80%', 'height': '80%'};\n\n        } else if ((dataArray[0].length === 2) && (dataArray[0][1] ===  \"\")) {\n            options.legend = {position: \"none\"};\n        }\n\n        options = $.extend(true, {}, options, opts.gchart, extraOptions);\n\n        const result = $(\"<div>\").css({width: \"100%\", height: \"100%\"});\n        const wrapper = new google.visualization.ChartWrapper({dataTable, chartType, options});\n        wrapper.draw(result[0]);\n        result.bind(\"dblclick\", function() {\n            const editor = new google.visualization.ChartEditor();\n            google.visualization.events.addListener(editor, 'ok', () => editor.getChartWrapper().draw(result[0]));\n            return editor.openDialog(wrapper);\n        });\n        return result;\n    });\n\n    return $.pivotUtilities.gchart_renderers = {\n        \"Line Chart\": makeGoogleChart(\"LineChart\"),\n        \"Bar Chart\": makeGoogleChart(\"ColumnChart\"),\n        \"Stacked Bar Chart\": makeGoogleChart(\"ColumnChart\", {isStacked: true}),\n        \"Area Chart\": makeGoogleChart(\"AreaChart\", {isStacked: true}),\n        \"Scatter Chart\": makeGoogleChart(\"ScatterChart\")\n    };\n})(jQuery);\n"],"mappings":"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","ignoreList":[]}